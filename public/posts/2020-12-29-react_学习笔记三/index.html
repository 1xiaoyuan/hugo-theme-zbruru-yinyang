<!DOCTYPE html>
<html><head>
<title>React 学习笔记（三）</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="React 学习笔记（三）" />
<meta property="og:description" content="来源于：https://react.docschina.org/docs/forms.html
一、表单 在 React 中，html 表单元素的工作方式和其他的 DOM 元素不太一样，因为表单内部通常会保持一些内部的 state，比如下面这个纯 html 表单只接受一个名称：
&lt;form&gt; &lt;label&gt; 名字: &lt;input type=&#34;text&#34; name=&#34;name&#34; /&gt; &lt;/label&gt; &lt;input type=&#34;submit&#34; value=&#34;提交&#34; /&gt; &lt;/form&gt; 这个表单具有默认的 html 表单行为，即在用户提交表单之后自动刷新页面。如果你在 React 中执行相同的代码，它仍然有效。
但大多数情况下，使用 JavaScript 函数可以很方便的处理表单的提交， 同时还可以访问用户填写的表单数据。实现这种效果的标准方式是使用“受控组件”。
受控组件 在 html 中，表单元素比如&lt;input&gt;，&lt;textarea&gt;，&lt;select&gt;，这些表单元素通常自己维护 state，并根据用户输入进行更新。而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 setState() 来更新。
我们可以把两者结合起来，使 React 的 state 成为“唯一数据源”。渲染表单的 React 组件还控制着用户输入过程中表单发生的操作。被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”。
例如，如果我们想让前一个示例在提交时打印出名称，我们可以将表单写为受控组件：
class NameForm extends React.Component { constructor(props) { super(props); this.state = {value: &#39;&#39;}; this.handleChange = this.handleChange.bind(this); this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/2020-12-29-react_%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%89/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-29T13:26:00+00:00" />
<meta property="article:modified_time" content="2020-12-29T13:26:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="React 学习笔记（三）"/>
<meta name="twitter:description" content="来源于：https://react.docschina.org/docs/forms.html
一、表单 在 React 中，html 表单元素的工作方式和其他的 DOM 元素不太一样，因为表单内部通常会保持一些内部的 state，比如下面这个纯 html 表单只接受一个名称：
&lt;form&gt; &lt;label&gt; 名字: &lt;input type=&#34;text&#34; name=&#34;name&#34; /&gt; &lt;/label&gt; &lt;input type=&#34;submit&#34; value=&#34;提交&#34; /&gt; &lt;/form&gt; 这个表单具有默认的 html 表单行为，即在用户提交表单之后自动刷新页面。如果你在 React 中执行相同的代码，它仍然有效。
但大多数情况下，使用 JavaScript 函数可以很方便的处理表单的提交， 同时还可以访问用户填写的表单数据。实现这种效果的标准方式是使用“受控组件”。
受控组件 在 html 中，表单元素比如&lt;input&gt;，&lt;textarea&gt;，&lt;select&gt;，这些表单元素通常自己维护 state，并根据用户输入进行更新。而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 setState() 来更新。
我们可以把两者结合起来，使 React 的 state 成为“唯一数据源”。渲染表单的 React 组件还控制着用户输入过程中表单发生的操作。被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”。
例如，如果我们想让前一个示例在提交时打印出名称，我们可以将表单写为受控组件：
class NameForm extends React.Component { constructor(props) { super(props); this.state = {value: &#39;&#39;}; this.handleChange = this.handleChange.bind(this); this."/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  






<link rel="stylesheet" href="/scss/journal.min.0f46f98b723f2aad4b02d9370bb6aa7848b5c2b2a5579642014082283683d2d8.css" integrity="sha256-D0b5i3I/Kq1LAtk3C7aqeEi1wrKlV5ZCAUCCKDaD0tg=" media="screen">



<link rel="stylesheet" href="/scss/dark-mode.min.79c34391dbcff20df8b4dac718e2606701efcbfdb9f3b08447ac39ac9dc7b463.css" integrity="sha256-ecNDkdvP8g34tNrHGOJgZwHvy/2587CER6w5rJ3HtGM=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="/vendor/js/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
  clientID: 'your client id',
  clientSecret: 'your client secret',
  repo: 'repo name',
  owner: 'user',
  admin: ['user'],
  id: md5(location.pathname),
  distractionFreeMode: 'false'
  });
  window.onload = function () {
        gitalk.render('gitalk-container')
  }
</script>












</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="http://example.org/">
    
        <div class="nav-title">
            A Hugo Site
        </div>
        
        <div class="nav-subtitle">
            Themed by Diary.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%b8%80%e8%a1%a8%e5%8d%95" onclick="onNavClick(`#一表单-nav`)" id="一表单-nav">
									一、表单
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6" onclick="onNavClick(`#受控组件-nav`)" id="受控组件-nav">
									受控组件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#textarea-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#textarea-标签-nav`)" id="textarea-标签-nav">
									textarea 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#select-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#select-标签-nav`)" id="select-标签-nav">
									select 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%87%e4%bb%b6-input-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#文件-input-标签-nav`)" id="文件-input-标签-nav">
									文件 input 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%84%e7%90%86%e5%a4%9a%e4%b8%aa%e8%be%93%e5%85%a5" onclick="onNavClick(`#处理多个输入-nav`)" id="处理多个输入-nav">
									处理多个输入
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e8%be%93%e5%85%a5%e7%a9%ba%e5%80%bc" onclick="onNavClick(`#受控输入空值-nav`)" id="受控输入空值-nav">
									受控输入空值
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81" onclick="onNavClick(`#受控组件的替代品-nav`)" id="受控组件的替代品-nav">
									受控组件的替代品
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%88%90%e7%86%9f%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" onclick="onNavClick(`#成熟的解决方案-nav`)" id="成熟的解决方案-nav">
									成熟的解决方案
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%b8%80%e8%a1%a8%e5%8d%95" onclick="onNavClick(`#一表单-nav`)" id="一表单-nav">
									一、表单
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6" onclick="onNavClick(`#受控组件-nav`)" id="受控组件-nav">
									受控组件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#textarea-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#textarea-标签-nav`)" id="textarea-标签-nav">
									textarea 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#select-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#select-标签-nav`)" id="select-标签-nav">
									select 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%96%87%e4%bb%b6-input-%e6%a0%87%e7%ad%be" onclick="onNavClick(`#文件-input-标签-nav`)" id="文件-input-标签-nav">
									文件 input 标签
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%84%e7%90%86%e5%a4%9a%e4%b8%aa%e8%be%93%e5%85%a5" onclick="onNavClick(`#处理多个输入-nav`)" id="处理多个输入-nav">
									处理多个输入
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e8%be%93%e5%85%a5%e7%a9%ba%e5%80%bc" onclick="onNavClick(`#受控输入空值-nav`)" id="受控输入空值-nav">
									受控输入空值
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81" onclick="onNavClick(`#受控组件的替代品-nav`)" id="受控组件的替代品-nav">
									受控组件的替代品
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%88%90%e7%86%9f%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" onclick="onNavClick(`#成熟的解决方案-nav`)" id="成熟的解决方案-nav">
									成熟的解决方案
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="http://example.org/">
            A Hugo Site
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="http://example.org/">
        <div class="single-column-header-title">A Hugo Site</div>
        
        <div class="single-column-header-subtitle">Themed by Diary.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    React 学习笔记（三）
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2020-12-29 13:26
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/">[技术]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/%E7%AC%94%E8%AE%B0">笔记</a>
                                &nbsp;
                            
                                <a href="/tags/react">react</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>来源于：<a href="https://react.docschina.org/docs/forms.html">https://react.docschina.org/docs/forms.html</a></p>
<h2 id="一表单">一、表单</h2>
<p>在 React 中，html 表单元素的工作方式和其他的 DOM 元素不太一样，因为表单内部通常会保持一些内部的 <code>state</code>，比如下面这个纯 html 表单只接受一个名称：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#8b008b;font-weight:bold">form</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">label</span>&gt;
</span></span><span style="display:flex;"><span>    名字:
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#8b008b;font-weight:bold">input</span> <span style="color:#658b00">type</span>=<span style="color:#cd5555">&#34;text&#34;</span> <span style="color:#658b00">name</span>=<span style="color:#cd5555">&#34;name&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#8b008b;font-weight:bold">label</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">input</span> <span style="color:#658b00">type</span>=<span style="color:#cd5555">&#34;submit&#34;</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">&#34;提交&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#8b008b;font-weight:bold">form</span>&gt;
</span></span></code></pre></div><p>这个表单具有默认的 html 表单行为，即在用户提交表单之后自动刷新页面。如果你在 React 中执行相同的代码，它仍然有效。</p>
<p>但大多数情况下，使用 JavaScript 函数可以很方便的处理表单的提交， 同时还可以访问用户填写的表单数据。实现这种效果的标准方式是使用“受控组件”。</p>
<h3 id="受控组件">受控组件</h3>
<p>在 html 中，表单元素比如<code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>，<code>&lt;select&gt;</code>，这些表单元素通常自己维护 <code>state</code>，并根据用户输入进行更新。而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 <code>setState()</code> 来更新。</p>
<p>我们可以把两者结合起来，使 React 的 state 成为“唯一数据源”。渲染表单的 React 组件还控制着用户输入过程中表单发生的操作。被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”。</p>
<p>例如，如果我们想让前一个示例在提交时打印出名称，我们可以将表单写为受控组件：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">class</span> NameForm <span style="color:#8b008b;font-weight:bold">extends</span> React.Component {
</span></span><span style="display:flex;"><span>  constructor(props) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">super</span>(props);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.state = {value: <span style="color:#cd5555">&#39;&#39;</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleChange = <span style="color:#8b008b;font-weight:bold">this</span>.handleChange.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit = <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleChange(event) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.setState({value: event.target.value});
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleSubmit(event) {
</span></span><span style="display:flex;"><span>    alert(<span style="color:#cd5555">&#39;提交的名字: &#39;</span> + <span style="color:#8b008b;font-weight:bold">this</span>.state.value);
</span></span><span style="display:flex;"><span>    event.preventDefault();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  render() {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>      &lt;form onSubmit={<span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit}&gt;
</span></span><span style="display:flex;"><span>        &lt;label&gt;
</span></span><span style="display:flex;"><span>          名字:
</span></span><span style="display:flex;"><span>          &lt;input type=<span style="color:#cd5555">&#34;text&#34;</span> value={<span style="color:#8b008b;font-weight:bold">this</span>.state.value} onChange={<span style="color:#8b008b;font-weight:bold">this</span>.handleChange} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a61717;background-color:#e3d2d2">/label&gt;</span>
</span></span><span style="display:flex;"><span>        &lt;input type=<span style="color:#cd5555">&#34;submit&#34;</span> value=<span style="color:#cd5555">&#34;提交&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#a61717;background-color:#e3d2d2">/form&gt;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>由于在表单元素上设置了 <code>value</code> 属性，因此显示的值将始终为 <code>this.state.value</code>，这使得 React 的 state 成为唯一数据源。由于 <code>handlechange</code> 在每次按键时都会执行并更新 React 的 state，因此显示的值将随着用户输入而更新。</p>
<p>对于受控组件来说，输入的值始终由 React 的 state 驱动。你也可以将 value 传递给其他 UI 元素，或者通过其他事件处理函数重置，但这意味着你需要编写更多的代码。</p>
<h3 id="textarea-标签">textarea 标签</h3>
<p>在 html 中，<code>&lt;textarea&gt;</code> 元素通过其子元素定义其文本：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#8b008b;font-weight:bold">textarea</span>&gt;
</span></span><span style="display:flex;"><span>  测试！
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#8b008b;font-weight:bold">textarea</span>&gt;
</span></span></code></pre></div><p>而在 React 中，<code>&lt;textarea&gt;</code> 使用 <code>value</code> 属性代替。这样，可以使得使用 <code>&lt;textarea&gt;</code> 的表单和使用单行 input 的表单非常类似：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">class</span> EssayForm <span style="color:#8b008b;font-weight:bold">extends</span> React.Component {
</span></span><span style="display:flex;"><span>  constructor(props) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">super</span>(props);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.state = {
</span></span><span style="display:flex;"><span>      value: <span style="color:#cd5555">&#39;请撰写一篇关于你喜欢的 DOM 元素的文章.&#39;</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleChange = <span style="color:#8b008b;font-weight:bold">this</span>.handleChange.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit = <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleChange(event) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.setState({value: event.target.value});
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleSubmit(event) {
</span></span><span style="display:flex;"><span>    alert(<span style="color:#cd5555">&#39;提交的文章: &#39;</span> + <span style="color:#8b008b;font-weight:bold">this</span>.state.value);
</span></span><span style="display:flex;"><span>    event.preventDefault();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  render() {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>      &lt;form onSubmit={<span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit}&gt;
</span></span><span style="display:flex;"><span>        &lt;label&gt;
</span></span><span style="display:flex;"><span>          文章:
</span></span><span style="display:flex;"><span>          &lt;textarea value={<span style="color:#8b008b;font-weight:bold">this</span>.state.value} onChange={<span style="color:#8b008b;font-weight:bold">this</span>.handleChange} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a61717;background-color:#e3d2d2">/label&gt;</span>
</span></span><span style="display:flex;"><span>        &lt;input type=<span style="color:#cd5555">&#34;submit&#34;</span> value=<span style="color:#cd5555">&#34;提交&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#a61717;background-color:#e3d2d2">/form&gt;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>请注意，<code>this.state.value</code> 初始化于构造函数中，因此文本区域默认有初值。</p>
<h3 id="select-标签">select 标签</h3>
<p>在 HTML 中，<code>&lt;select&gt;</code> 创建下拉列表标签。例如，如下 html 创建了水果相关的下拉列表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#8b008b;font-weight:bold">select</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">option</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">&#34;grapefruit&#34;</span>&gt;葡萄柚&lt;/<span style="color:#8b008b;font-weight:bold">option</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">option</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">&#34;lime&#34;</span>&gt;酸橙&lt;/<span style="color:#8b008b;font-weight:bold">option</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">option</span> <span style="color:#658b00">selected</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">&#34;coconut&#34;</span>&gt;椰子&lt;/<span style="color:#8b008b;font-weight:bold">option</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#8b008b;font-weight:bold">option</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">&#34;mango&#34;</span>&gt;芒果&lt;/<span style="color:#8b008b;font-weight:bold">option</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#8b008b;font-weight:bold">select</span>&gt;
</span></span></code></pre></div><p>请注意，由于 <code>selected</code> 属性的缘故，椰子选项默认被选中。React 并不会使用 <code>selected</code> 属性，而是在根 <code>select</code> 标签上使用 <code>value</code> 属性。这在受控组件中更便捷，因为您只需要在根标签中更新它。例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">class</span> FlavorForm <span style="color:#8b008b;font-weight:bold">extends</span> React.Component {
</span></span><span style="display:flex;"><span>  constructor(props) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">super</span>(props);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.state = {value: <span style="color:#cd5555">&#39;coconut&#39;</span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleChange = <span style="color:#8b008b;font-weight:bold">this</span>.handleChange.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit = <span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleChange(event) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.setState({value: event.target.value});
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleSubmit(event) {
</span></span><span style="display:flex;"><span>    alert(<span style="color:#cd5555">&#39;你喜欢的风味是: &#39;</span> + <span style="color:#8b008b;font-weight:bold">this</span>.state.value);
</span></span><span style="display:flex;"><span>    event.preventDefault();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  render() {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>      &lt;form onSubmit={<span style="color:#8b008b;font-weight:bold">this</span>.handleSubmit}&gt;
</span></span><span style="display:flex;"><span>        &lt;label&gt;
</span></span><span style="display:flex;"><span>          选择你喜欢的风味:
</span></span><span style="display:flex;"><span>          &lt;select value={<span style="color:#8b008b;font-weight:bold">this</span>.state.value} onChange={<span style="color:#8b008b;font-weight:bold">this</span>.handleChange}&gt;
</span></span><span style="display:flex;"><span>            &lt;option value=<span style="color:#cd5555">&#34;grapefruit&#34;</span>&gt;葡萄柚&lt;<span style="color:#a61717;background-color:#e3d2d2">/option&gt;</span>
</span></span><span style="display:flex;"><span>            &lt;option value=<span style="color:#cd5555">&#34;lime&#34;</span>&gt;酸橙&lt;<span style="color:#a61717;background-color:#e3d2d2">/option&gt;</span>
</span></span><span style="display:flex;"><span>            &lt;option value=<span style="color:#cd5555">&#34;coconut&#34;</span>&gt;椰子&lt;<span style="color:#a61717;background-color:#e3d2d2">/option&gt;</span>
</span></span><span style="display:flex;"><span>            &lt;option value=<span style="color:#cd5555">&#34;mango&#34;</span>&gt;芒果&lt;<span style="color:#a61717;background-color:#e3d2d2">/option&gt;</span>
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#a61717;background-color:#e3d2d2">/select&gt;</span>
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a61717;background-color:#e3d2d2">/label&gt;</span>
</span></span><span style="display:flex;"><span>        &lt;input type=<span style="color:#cd5555">&#34;submit&#34;</span> value=<span style="color:#cd5555">&#34;提交&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#a61717;background-color:#e3d2d2">/form&gt;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>总的来说，这使得 <code>&lt;input type=&quot;text&quot;&gt;</code>, <code>&lt;textarea&gt;</code> 和 <code>&lt;select&gt;</code> 之类的标签都非常相似—它们都接受一个 value 属性，你可以使用它来实现受控组件。</p>
<blockquote>
<p>注意:你可以将数组传递到 value 属性中，以支持在 select 标签中选择多个选项：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#8b008b;font-weight:bold">select</span> <span style="color:#658b00">multiple</span>=<span style="color:#cd5555">{true}</span> <span style="color:#658b00">value</span>=<span style="color:#cd5555">{[&#39;B&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span><span style="color:#658b00">C</span><span style="color:#a61717;background-color:#e3d2d2">&#39;]}</span>&gt;
</span></span></code></pre></div></blockquote>
<h3 id="文件-input-标签">文件 input 标签</h3>
<p>在 HTML 中，<code>&lt;input type=&quot;file&quot;&gt;</code> 允许用户从存储设备中选择一个或多个文件，将其上传到服务器，或通过使用 JavaScript 的 <code>File API</code> 进行控制。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#8b008b;font-weight:bold">input</span> <span style="color:#658b00">type</span>=<span style="color:#cd5555">&#34;file&#34;</span> /&gt;
</span></span></code></pre></div><p>因为它的 value 只读，所以它是 React 中的一个非受控组件。</p>
<h3 id="处理多个输入">处理多个输入</h3>
<p>当需要处理多个 <code>input</code> 元素时，我们可以给每个元素添加 <code>name</code> 属性，并让处理函数根据 <code>event.target.name</code> 的值选择要执行的操作。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">class</span> Reservation <span style="color:#8b008b;font-weight:bold">extends</span> React.Component {
</span></span><span style="display:flex;"><span>  constructor(props) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">super</span>(props);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.state = {
</span></span><span style="display:flex;"><span>      isGoing: <span style="color:#8b008b;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span>      numberOfGuests: <span style="color:#b452cd">2</span>
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.handleInputChange = <span style="color:#8b008b;font-weight:bold">this</span>.handleInputChange.bind(<span style="color:#8b008b;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  handleInputChange(event) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> target = event.target;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> value = target.name === <span style="color:#cd5555">&#39;isGoing&#39;</span> ? target.checked : target.value;
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">const</span> name = target.name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">this</span>.setState({
</span></span><span style="display:flex;"><span>      [name]: value
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  render() {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>      &lt;form&gt;
</span></span><span style="display:flex;"><span>        &lt;label&gt;
</span></span><span style="display:flex;"><span>          参与:
</span></span><span style="display:flex;"><span>          &lt;input
</span></span><span style="display:flex;"><span>            name=<span style="color:#cd5555">&#34;isGoing&#34;</span>
</span></span><span style="display:flex;"><span>            type=<span style="color:#cd5555">&#34;checkbox&#34;</span>
</span></span><span style="display:flex;"><span>            checked={<span style="color:#8b008b;font-weight:bold">this</span>.state.isGoing}
</span></span><span style="display:flex;"><span>            onChange={<span style="color:#8b008b;font-weight:bold">this</span>.handleInputChange} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a61717;background-color:#e3d2d2">/label&gt;</span>
</span></span><span style="display:flex;"><span>        &lt;br /&gt;
</span></span><span style="display:flex;"><span>        &lt;label&gt;
</span></span><span style="display:flex;"><span>          来宾人数:
</span></span><span style="display:flex;"><span>          &lt;input
</span></span><span style="display:flex;"><span>            name=<span style="color:#cd5555">&#34;numberOfGuests&#34;</span>
</span></span><span style="display:flex;"><span>            type=<span style="color:#cd5555">&#34;number&#34;</span>
</span></span><span style="display:flex;"><span>            value={<span style="color:#8b008b;font-weight:bold">this</span>.state.numberOfGuests}
</span></span><span style="display:flex;"><span>            onChange={<span style="color:#8b008b;font-weight:bold">this</span>.handleInputChange} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#a61717;background-color:#e3d2d2">/label&gt;</span>
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#a61717;background-color:#e3d2d2">/form&gt;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这里使用了 ES6 <code>计算属性名称</code>的语法更新给定输入名称对应的 state 值：</p>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">this</span>.setState({
</span></span><span style="display:flex;"><span>  [name]: value
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>等同于 es5：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">var</span> partialState = {};
</span></span><span style="display:flex;"><span>partialState[name] = value;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">this</span>.setState(partialState);
</span></span></code></pre></div><p>另外，由于 <code>setState()</code> 自动将部分 state 合并到当前 state, 只需调用它更改部分 state 即可。</p>
<h3 id="受控输入空值">受控输入空值</h3>
<p>在受控组件上指定 value 的 prop 会阻止用户更改输入。如果你指定了 <code>value</code>，但输入仍可编辑，则可能是你意外地将 <code>value</code> 设置为 <code>undefined</code> 或 <code>null</code>。</p>
<p>下面的代码演示了这一点。（输入最初被锁定，但在短时间延迟后变为可编辑。）</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>ReactDOM.render(&lt;input value=<span style="color:#cd5555">&#34;hi&#34;</span> /&gt;, mountNode);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>setTimeout(<span style="color:#8b008b;font-weight:bold">function</span>() {
</span></span><span style="display:flex;"><span>  ReactDOM.render(&lt;input value={<span style="color:#8b008b;font-weight:bold">null</span>} /&gt;, mountNode);
</span></span><span style="display:flex;"><span>}, <span style="color:#b452cd">1000</span>);
</span></span></code></pre></div><h3 id="受控组件的替代品">受控组件的替代品</h3>
<p>有时使用受控组件会很麻烦，因为你需要为数据变化的每种方式都编写事件处理函数，并通过一个 React 组件传递所有的输入 state。当你将之前的代码库转换为 React 或将 React 应用程序与非 React 库集成时，这可能会令人厌烦。在这些情况下，你可能希望使用非受控组件, 这是实现输入表单的另一种方式。</p>
<h3 id="成熟的解决方案">成熟的解决方案</h3>
<p>如果你想寻找包含验证、追踪访问字段以及处理表单提交的完整解决方案，使用 Formik 是不错的选择。然而，它也是建立在受控组件和管理 state 的基础之上 —— 所以不要忽视学习它们。</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2020-12-29</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/2021-01-01-%E4%B8%BA%E4%BB%80%E4%B9%88_key_%E6%98%AF%E5%BF%85%E9%A1%BB%E7%9A%84/">
			Next<br>为什么 key 是必须的？
                </a>
                
                
                
                <a class="older-posts" href="/posts/2020-12-25-2020%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/">
			Previous<br>2020年度总结
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                


<div id="gitalk-container"></div>









            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
